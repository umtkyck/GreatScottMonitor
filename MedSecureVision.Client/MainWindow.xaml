<Window x:Class="MedSecureVision.Client.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MedSecure Vision" Height="600" Width="800"
        WindowStyle="None" AllowsTransparency="True" Background="Transparent"
        WindowStartupLocation="CenterScreen" ResizeMode="NoResize">
    <Window.Resources>
        <Style TargetType="Window">
            <Setter Property="Background" Value="#1E1E1E"/>
        </Style>
    </Window.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Camera Feed with Face Guide Overlay -->
        <Grid Grid.Row="0" Name="CameraContainer">
            <Image Name="CameraFeed" Stretch="UniformToFill" Source="{Binding CameraFeed}"/>
            
            <!-- Oval Face Guide -->
            <Ellipse Name="FaceGuide" 
                     Width="300" Height="400"
                     Stroke="#00FF00" 
                     StrokeThickness="3"
                     Opacity="0.8"
                     HorizontalAlignment="Center"
                     VerticalAlignment="Center"
                     RenderTransformOrigin="0.5,0.5">
                <Ellipse.RenderTransform>
                    <ScaleTransform x:Name="FaceGuideScale" ScaleX="1" ScaleY="1"/>
                </Ellipse.RenderTransform>
                <Ellipse.Style>
                    <Style TargetType="Ellipse">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding AuthenticationState}" Value="Searching">
                                <Setter Property="Stroke" Value="#00FF00"/>
                                <DataTrigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                                             From="0.5" To="0.8" Duration="0:0:1"
                                                             RepeatBehavior="Forever" AutoReverse="True"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </DataTrigger.EnterActions>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding AuthenticationState}" Value="Verifying">
                                <Setter Property="Stroke" Value="#FFFF00"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding AuthenticationState}" Value="Success">
                                <Setter Property="Stroke" Value="#00FF00"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding AuthenticationState}" Value="Failure">
                                <Setter Property="Stroke" Value="#FF0000"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Ellipse.Style>
            </Ellipse>

            <!-- Scanning Line Animation -->
            <Rectangle Name="ScanningLine" 
                       Width="300" Height="2"
                       Fill="#00FF00"
                       Opacity="0.6"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"
                       Visibility="{Binding ScanningLineVisible, Converter={StaticResource BoolToVisibilityConverter}}">
                <Rectangle.RenderTransform>
                    <TranslateTransform x:Name="ScanningLineTransform" Y="0"/>
                </Rectangle.RenderTransform>
            </Rectangle>

            <!-- Status Message -->
            <TextBlock Name="StatusMessage"
                       Text="{Binding StatusMessage}"
                       Foreground="White"
                       FontSize="18"
                       FontWeight="Bold"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Bottom"
                       Margin="0,0,0,100"
                       TextAlignment="Center"/>

            <!-- Success Checkmark -->
            <Path Name="SuccessCheckmark"
                  Data="M 0,0 L 10,10 L 20,0"
                  Stroke="#00FF00"
                  StrokeThickness="4"
                  StrokeLinecap="Round"
                  StrokeLineJoin="Round"
                  HorizontalAlignment="Center"
                  VerticalAlignment="Center"
                  Visibility="{Binding ShowSuccessCheckmark, Converter={StaticResource BoolToVisibilityConverter}}"
                  Opacity="0">
                <Path.RenderTransform>
                    <ScaleTransform x:Name="CheckmarkScale" ScaleX="0" ScaleY="0"/>
                </Path.RenderTransform>
            </Path>
        </Grid>

        <!-- Bottom Status Bar -->
        <Border Grid.Row="1" Background="#2D2D2D" Padding="20,10">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                <TextBlock Text="{Binding StatusText}" 
                          Foreground="White" 
                          FontSize="14"
                          VerticalAlignment="Center"/>
            </StackPanel>
        </Border>
    </Grid>
</Window>

