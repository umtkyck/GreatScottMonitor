<Window x:Class="CXA.Client.Views.DashboardWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="CXA - Biometric Authentication" Height="700" Width="1200"
        WindowStyle="None" AllowsTransparency="True" Background="Transparent"
        WindowStartupLocation="CenterScreen"
        MouseLeftButtonDown="Window_MouseLeftButtonDown">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Resources/Styles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            
            <!-- Pulse Animation for Status -->
            <Storyboard x:Key="StatusPulse" RepeatBehavior="Forever">
                <DoubleAnimation Storyboard.TargetName="CameraGlow"
                                 Storyboard.TargetProperty="Opacity"
                                 From="0.3" To="0.7" Duration="0:0:1.5" AutoReverse="True">
                    <DoubleAnimation.EasingFunction>
                        <SineEase EasingMode="EaseInOut"/>
                    </DoubleAnimation.EasingFunction>
                </DoubleAnimation>
            </Storyboard>
        </ResourceDictionary>
    </Window.Resources>

    <Window.Triggers>
        <EventTrigger RoutedEvent="Window.Loaded">
            <BeginStoryboard Storyboard="{StaticResource StatusPulse}"/>
        </EventTrigger>
    </Window.Triggers>

    <!-- Main Container -->
    <Border CornerRadius="20" ClipToBounds="True">
        <Border.Background>
            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                <GradientStop Color="#0A0E14" Offset="0"/>
                <GradientStop Color="#0D1117" Offset="0.5"/>
                <GradientStop Color="#161B22" Offset="1"/>
            </LinearGradientBrush>
        </Border.Background>
        <Border.Effect>
            <DropShadowEffect BlurRadius="50" ShadowDepth="0" Opacity="0.9" Color="#000000"/>
        </Border.Effect>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="60"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="40"/>
            </Grid.RowDefinitions>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 HEADER BAR
            â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <Border Grid.Row="0" Background="#0D1117" BorderBrush="#21262D" BorderThickness="0,0,0,1">
                <Grid Margin="20,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Logo & Title -->
                    <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                        <Border Width="36" Height="36" CornerRadius="10" Margin="0,0,12,0">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Color="#58A6FF" Offset="0"/>
                                    <GradientStop Color="#A371F7" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                            <TextBlock Text="ðŸ”" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <StackPanel VerticalAlignment="Center">
                            <TextBlock Text="CXA" FontSize="18" FontWeight="Bold" Foreground="#F0F6FC"/>
                            <TextBlock Text="Biometric Authentication" FontSize="10" Foreground="#8B949E" Margin="0,-2,0,0"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- Status Indicator -->
                    <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                        <Ellipse x:Name="StatusIndicator" Width="10" Height="10" Fill="#3FB950" Margin="0,0,8,0">
                            <Ellipse.Effect>
                                <DropShadowEffect BlurRadius="8" ShadowDepth="0" Color="#3FB950" Opacity="0.6"/>
                            </Ellipse.Effect>
                        </Ellipse>
                        <TextBlock x:Name="StatusText" Text="Ready" FontSize="13" Foreground="#8B949E"/>
                    </StackPanel>

                    <!-- Window Controls -->
                    <StackPanel Grid.Column="2" Orientation="Horizontal">
                        <Button Style="{StaticResource IconButton}" Click="MinimizeButton_Click" Width="32" Height="32" ToolTip="Minimize">
                            <TextBlock Text="â”€" FontSize="12" Foreground="#8B949E"/>
                        </Button>
                        <Button x:Name="MaximizeButton" Style="{StaticResource IconButton}" Click="MaximizeButton_Click" Width="32" Height="32" ToolTip="Maximize">
                            <TextBlock x:Name="MaximizeIcon" Text="â˜" FontSize="14" Foreground="#8B949E"/>
                        </Button>
                        <Button Style="{StaticResource IconButton}" Click="CloseButton_Click" Width="32" Height="32" ToolTip="Close to Tray">
                            <TextBlock Text="âœ•" FontSize="12" Foreground="#8B949E"/>
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 MAIN CONTENT - 3 Column Layout
            â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <Grid Grid.Row="1" Margin="20">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="320"/>
                    <ColumnDefinition Width="20"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     LEFT PANEL - Camera & Authentication
                â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <Border Grid.Column="0" Style="{StaticResource GlassCard}" Padding="0">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Camera Header -->
                        <Border Grid.Row="0" Background="#161B22" Padding="16,12">
                            <StackPanel Orientation="Horizontal">
                                <Ellipse x:Name="CameraStatusDot" Width="8" Height="8" Fill="#3FB950" Margin="0,0,10,0"/>
                                <TextBlock Text="LIVE CAMERA" FontSize="11" FontWeight="SemiBold" Foreground="#8B949E"/>
                            </StackPanel>
                        </Border>

                        <!-- Camera Feed with Circular Mask -->
                        <Grid Grid.Row="1" Margin="20">
                            <Viewbox Stretch="Uniform" MaxWidth="260" MaxHeight="260">
                                <Canvas Width="260" Height="260">
                                    <!-- Glow Ring -->
                                    <Ellipse x:Name="CameraGlow" Width="260" Height="260" Opacity="0.5">
                                        <Ellipse.Fill>
                                            <RadialGradientBrush>
                                                <GradientStop Color="#4058A6FF" Offset="0.7"/>
                                                <GradientStop Color="#0058A6FF" Offset="1"/>
                                            </RadialGradientBrush>
                                        </Ellipse.Fill>
                                    </Ellipse>
                                    
                                    <!-- Camera Frame Border -->
                                    <Ellipse Width="240" Height="240" Canvas.Left="10" Canvas.Top="10" 
                                             Stroke="#30363D" StrokeThickness="4" Fill="Transparent"/>
                                    
                                    <!-- Camera Feed (Circular) -->
                                    <Border Canvas.Left="20" Canvas.Top="20" Width="220" Height="220" 
                                            CornerRadius="110" ClipToBounds="True">
                                        <Border.Background>
                                            <ImageBrush x:Name="CameraFeedBrush" Stretch="UniformToFill"/>
                                        </Border.Background>
                                        <!-- Fallback when no camera -->
                                        <Grid x:Name="NoCameraPlaceholder" Visibility="Visible">
                                            <Ellipse Fill="#21262D"/>
                                            <TextBlock Text="ðŸ“·" FontSize="48" HorizontalAlignment="Center" 
                                                       VerticalAlignment="Center" Opacity="0.3"/>
                                        </Grid>
                                    </Border>
                                    
                                    <!-- Success Checkmark Overlay -->
                                    <Canvas x:Name="SuccessOverlay" Width="260" Height="260" Opacity="0">
                                        <Ellipse Width="100" Height="100" Canvas.Left="80" Canvas.Top="80" Fill="#238636"/>
                                        <Path Data="M95,130 L120,155 L165,105" Stroke="White" StrokeThickness="8" 
                                              StrokeStartLineCap="Round" StrokeEndLineCap="Round" StrokeLineJoin="Round"/>
                                    </Canvas>
                                </Canvas>
                            </Viewbox>
                        </Grid>

                        <!-- Auth Status & Controls -->
                        <StackPanel Grid.Row="2" Margin="16,0,16,16">
                            <TextBlock x:Name="AuthStatusText" Text="Looking for face..." 
                                       FontSize="14" Foreground="#F0F6FC" TextAlignment="Center" 
                                       FontWeight="SemiBold" Margin="0,0,0,8"/>
                            <TextBlock x:Name="AuthSubText" Text="Position your face in the circle" 
                                       FontSize="12" Foreground="#8B949E" TextAlignment="Center" Margin="0,0,0,16"/>
                            
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="8"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Button Grid.Column="0" x:Name="EnrollButton" Content="ðŸ‘¤ Enroll" 
                                        Style="{StaticResource PrimaryButton}" Click="EnrollButton_Click"/>
                                <Button Grid.Column="2" Content="ðŸ”‘ PIN" 
                                        Style="{StaticResource ModernButton}" Click="PinButton_Click"/>
                            </Grid>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     RIGHT PANEL - Face Management
                â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <Grid Grid.Column="2">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Section Header with Stats -->
                    <Grid Grid.Row="0" Margin="0,0,0,16">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0" Orientation="Horizontal">
                            <TextBlock Text="Enrolled Faces" FontSize="18" FontWeight="SemiBold" Foreground="#F0F6FC"/>
                            <Border Background="#21262D" CornerRadius="10" Padding="10,4" Margin="12,0,0,0">
                                <TextBlock x:Name="FaceCountBadge" Text="0" FontSize="12" Foreground="#58A6FF" FontWeight="Bold"/>
                            </Border>
                        </StackPanel>

                        <!-- Quick Stats -->
                        <StackPanel Grid.Column="2" Orientation="Horizontal">
                            <Border Background="#1A3D2A" CornerRadius="8" Padding="12,6" Margin="0,0,8,0">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="âœ“" Foreground="#3FB950" FontWeight="Bold" Margin="0,0,6,0"/>
                                    <TextBlock x:Name="AuthsTodayText" Text="0" Foreground="#3FB950" FontWeight="SemiBold"/>
                                    <TextBlock Text=" today" Foreground="#8B949E" FontSize="11"/>
                                </StackPanel>
                            </Border>
                            <Button Content="+ Add Face" Style="{StaticResource PrimaryButton}" 
                                    Padding="16,8" Click="AddNewFace_Click"/>
                        </StackPanel>
                    </Grid>

                    <!-- Face Cards Area -->
                    <Border Grid.Row="1" Style="{StaticResource GlassCard}" Padding="16">
                        <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                            <Grid>
                                <!-- Empty State -->
                                <Border x:Name="EmptyState" Visibility="Visible">
                                    <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Margin="40">
                                        <Border Width="80" Height="80" CornerRadius="40" Background="#21262D" Margin="0,0,0,20">
                                            <TextBlock Text="ðŸ‘¤" FontSize="36" HorizontalAlignment="Center" 
                                                       VerticalAlignment="Center" Opacity="0.4"/>
                                        </Border>
                                        <TextBlock Text="No faces enrolled" FontSize="18" FontWeight="SemiBold" 
                                                   Foreground="#F0F6FC" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                        <TextBlock Text="Enroll your face to enable biometric authentication" 
                                                   FontSize="13" Foreground="#8B949E" TextAlignment="Center" 
                                                   TextWrapping="Wrap" MaxWidth="280" Margin="0,0,0,20"/>
                                        <Button Content="âž• Enroll Now" Style="{StaticResource PrimaryButton}"
                                                Padding="24,12" Click="EnrollButton_Click"/>
                                    </StackPanel>
                                </Border>

                                <!-- Face Cards Grid -->
                                <ItemsControl x:Name="FacesGrid" Visibility="Collapsed">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <WrapPanel Orientation="Horizontal"/>
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Style="{StaticResource GlassCard}" Width="200" Margin="0,0,12,12" 
                                                    Padding="16" Background="#161B22">
                                                <Grid>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>
                                                    
                                                    <!-- Avatar & Name -->
                                                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,12">
                                                        <Border Width="48" Height="48" CornerRadius="24" 
                                                                Background="#1F3A5F" Margin="0,0,12,0">
                                                            <TextBlock Text="{Binding Initials}" FontSize="18" 
                                                                       FontWeight="SemiBold" Foreground="#58A6FF"
                                                                       HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                        </Border>
                                                        <StackPanel VerticalAlignment="Center">
                                                            <TextBlock Text="{Binding Name}" FontSize="14" 
                                                                       FontWeight="SemiBold" Foreground="#F0F6FC"/>
                                                            <StackPanel Orientation="Horizontal">
                                                                <Ellipse Width="6" Height="6" Fill="{Binding StatusColor}" Margin="0,0,6,0"/>
                                                                <TextBlock Text="{Binding StatusText}" FontSize="11" Foreground="#8B949E"/>
                                                            </StackPanel>
                                                        </StackPanel>
                                                    </StackPanel>
                                                    
                                                    <!-- Meta -->
                                                    <TextBlock Grid.Row="1" FontSize="11" Foreground="#8B949E" Margin="0,0,0,12">
                                                        <Run Text="ðŸ“… "/>
                                                        <Run Text="{Binding EnrolledDate}"/>
                                                    </TextBlock>
                                                    
                                                    <!-- Actions -->
                                                    <Grid Grid.Row="2">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="8"/>
                                                            <ColumnDefinition Width="*"/>
                                                        </Grid.ColumnDefinitions>
                                                        <Button Grid.Column="0" Content="Edit" Style="{StaticResource ModernButton}"
                                                                FontSize="11" Padding="0,6" Click="EditFace_Click" Tag="{Binding}"/>
                                                        <Button Grid.Column="2" Content="Delete" Style="{StaticResource ModernButton}"
                                                                FontSize="11" Padding="0,6" Foreground="#F85149"
                                                                Click="DeleteFace_Click" Tag="{Binding}"/>
                                                    </Grid>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </Grid>
                        </ScrollViewer>
                    </Border>
                </Grid>
            </Grid>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 LOCK OVERLAY - Shows when not authenticated
            â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <Grid x:Name="LockOverlay" Grid.RowSpan="3" Visibility="Collapsed" Panel.ZIndex="100">
                <Border Background="#E5000000"/>
                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                    <!-- Lock Icon with Pulse Animation -->
                    <Border x:Name="LockIconBorder" Width="120" Height="120" CornerRadius="60" Margin="0,0,0,30">
                        <Border.Background>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                <GradientStop Color="#F85149" Offset="0"/>
                                <GradientStop Color="#DA3633" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="40" ShadowDepth="0" Color="#F85149" Opacity="0.5"/>
                        </Border.Effect>
                        <TextBlock Text="ðŸ”’" FontSize="48" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Border>
                    
                    <TextBlock x:Name="LockTitle" Text="Screen Locked" FontSize="32" FontWeight="Bold" 
                               Foreground="White" HorizontalAlignment="Center" Margin="0,0,0,12"/>
                    <TextBlock x:Name="LockMessage" Text="Show your face to unlock" FontSize="16" 
                               Foreground="#8B949E" HorizontalAlignment="Center" Margin="0,0,0,40"/>
                    
                    <!-- Small Camera Preview -->
                    <Border Width="160" Height="160" CornerRadius="80" BorderBrush="#30363D" BorderThickness="3">
                        <Border.Background>
                            <ImageBrush x:Name="LockCameraFeed" Stretch="UniformToFill"/>
                        </Border.Background>
                        <Grid x:Name="LockNoCameraPlaceholder" Visibility="Collapsed">
                            <Ellipse Fill="#21262D"/>
                            <TextBlock Text="ðŸ“·" FontSize="36" HorizontalAlignment="Center" VerticalAlignment="Center" Opacity="0.3"/>
                        </Grid>
                    </Border>
                    
                    <TextBlock x:Name="LockStatus" Text="Looking for face..." FontSize="13" 
                               Foreground="#8B949E" HorizontalAlignment="Center" Margin="0,16,0,0"/>
                    
                    <!-- PIN Fallback Button -->
                    <Button Content="ðŸ”‘ Use PIN Instead" Style="{StaticResource ModernButton}" 
                            Margin="0,30,0,0" Padding="24,12" Click="LockPinButton_Click"/>
                </StackPanel>
            </Grid>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 FOOTER
            â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <Border Grid.Row="2" Background="#0D1117" BorderBrush="#21262D" BorderThickness="0,1,0,0">
                <Grid Margin="20,0">
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Center">
                        <TextBlock Text="ðŸ”’" FontSize="11" Margin="0,0,6,0"/>
                        <TextBlock Text="Secure â€¢ Encrypted â€¢ Local Processing" FontSize="11" Foreground="#8B949E"/>
                    </StackPanel>
                    <TextBlock HorizontalAlignment="Right" VerticalAlignment="Center" FontSize="11" Foreground="#484F58">
                        <Run Text="CXA v"/>
                        <Run x:Name="VersionText" Text="R1M1-Release"/>
                    </TextBlock>
                </Grid>
            </Border>
        </Grid>
    </Border>
</Window>
